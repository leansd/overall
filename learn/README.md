# 写给初学软件开发的同学

本文简要介绍在实际工作中的软件开发团队会做哪些事情，大致涉及软件工程、项目管理方面知识，为初次接触行业的学生提供参考。


## 创建工程（项目）

    提示：工程和项目这两个词时常混着使用（都是project）。软件开发中会有多种知识背景的人一起协作，大家通人为项目是指代包含商业活动在内的所有事情。因此我们用工程来程来指代软件开发范围内的事情。
    一个工程，通常是一组可以独立管理的、可编译构建的源代码。工程与工程之间可以有依赖关系。工程划分不是固定的，可以不断进行调整来适应变化。工程的划分可以从方便管理、协作、测试、发布等角度考虑。


### 准备工作

大约有如下的事项要准备：
- 起名字、定用途、著作权
- 开发语言、构建工具、依赖管理、目录布局
- 使用的工具：代码仓库、IDE、CI/CD、测试工具、文档工具、协作工具、发布工具等等
- 必要的说明文档以及为项目制定的工作规范


    我们的项目名为leansd，意思是lean software development，是一个演进式设计的教学和演示项目。采用的协议是AGPL。目前划分出5个子工程：
    1. overall 项目的文档类文件，GFDL协议
    2. cotrip 主要的服务器端代码，使用Java编写，构建和依赖管理使用maven。旅行计划
    3. cotrip-miniapp 主要的前端GUI代码，小程序。 
    4. cotrip-deployment 部署脚本，环境采用k8s
    5. auth 身份认证转发代理

### 工程初始化

工程的准备工作即是建立基础代码的过程也是为协作制定基本的规范：

- 依次创建各工程的代码仓库
- 初始化各个仓库，REAMDME、LICENSE、.gitignore等等
- 必要的说明文件README.md，我们采用markdown格式
- 配置基本的分支策略和分支保护
- 完成各仓库的初次提交
- 必要的协作规范说明，我们放在overall里
- 配置基础的CI脚本

创建完成，准备正式工作。如果团队有相似工程资产的积累，还可以使用模板来创建工程，进一步节省时间。

    我们使用master作为默认分支，也是日常开发的主分支，如果有一些拿不定主意的代码，可以先创建独立的feature-*分支，完成后创建pull-request到master，经评审合并到master。
    里程碑与版本的发布，我们采用tag的方式，每次发布都会打一个tag。

    CI使用github actions，每次提交都会触发CI，CI会执行一些基本的检查，比如代码风格、单元测试等等。CI的结果会反馈到pull-request上，方便评审。

## 开展工作

软件开发工作是一个漫长的过程。 人员的变动，计划的变动都会影响其发展。记住最重要是不断的积累、调整和落实。

让我用一句话概括日常：

确定工作事项（需求、缺陷、改造、其他） → 编程与评审 → 验证无误 → 确定发布 → 监督、反馈与改进

- 确定工作事项：每一个版本或里程碑是有目标的，并围绕这个目标而确定工作事项以及人员。
- 编程与评审：每个事项的达成最重要的是思考，想出合理达成途径，其次是实际编写出代码。这个过程不是一次性瀑布过程， 而是一个不断反复迭代的过程。要不断与各方讨论、修订直至达成满意结果。
- 验证无误：验证是多个角度的，可以是自动化测试，也可以是人工测试，更需要用户参与验收。为完成验证设计各种角度的测试用例是必要的。
- 确定发布：目标达成时就要准备软件的发布，发布也是对工程的一个整理（对齐源代码、测试用例、各类脚本、文档说明等）。不同的软件有不同的发布方式，网站服务可以直接将存档的发布包择机部署到生产环境，移动程序则需要上传到应用商店待审核通过后通知用户更新。
- 监督、反馈与改进：发布算是软件工程活动的告一段落，但对于这个软件的生命周期才是刚刚开始。服务器端的软件需要不断的监督运行状态，及时发现问题并修复。移动端的软件则需要收集用户的反馈，及时修复问题。


    在开发过程中缺陷随时可能出现，经验表明缺陷发现的越晚，修复的成本越高[3]。
    这也是要在开发中使用持续集成的原因，在干净的环境构建以及开展自动化测试，避免错误重复发生，尽早得到反馈。

## 如何协作

完成软件开发仅是整个工程或项目的一部分，
往前还有需求的发现，讨论，成型，列入开发计划，往后还要有生产环境的运维，市场的推广，用户的反馈等等。
与不同知识背景的人共同协作，是专业技术人员必备的技能。

1）需求
软件的需求挖掘依赖于业务专家的敏锐嗅觉、用户的反馈、市场的动向、技术的发展等等，通过各类渠道收集，形成初步的需求意向。
再经过与技术专家讨论、修订形成正式的需求规格说明。
即便如此，需求仍然可能发生调整，可能在开发团队深入理解过程中发现新的缺点、难度、风险等因素而导致需求的调整。

2）排期
开发计划是项目管理的一部分，将长期的目标分解为短期的里程碑或增量迭代计划，并在每个版本中排入适当量的工作事项（需求、缺陷、改进）。
在每天的工作中还必须和各方沟通进展暴露风险，及时反馈进度，以及必要时进行调整。

3）部署和运维
软件通过验收后还会有部署工作，不同软件有不同的部署发布方法。
网站服务可以直接交由运维人员部署到生产环境，移动程序则需要上传到应用商店待审核通过由用户更新，桌面软件可能还需要专门工作人员上门更新，嵌入式软件则需要通过OTA等方式更新。
对软件生产运行的监控是一个持续的过程，使用监控软件收集各层面的数据观察运行状态，及时发现问题并修复。
监控之上还需要设置告警规则和通知，及时通知相关人员响应，预防问题扩大。
生产环境遇到故障必要时还需要进行紧急修复，这时候就需要运维人员和开发人员紧密协作。

4）反馈
软件的生命周期还包括用户的反馈，用户的反馈是软件改进的重要来源，需要及时收集、整理、分析、修复。
除了用户主动上报的问题之外，还有必要在软件中加入异常处理和故障收集机制，以便于及时发现问题。

大家都意识到，迭代增量式开发是一种更好的方式，早一点给客户演示开发中的产品获得反馈可以及时修正方向，而不是等到开发完成才发现问题。
这也是敏捷开发的核心思想，不断的迭代，不断的演进，不断的反馈，不断的改进。


## 延伸阅读

- CI, Continuous Integration，持续集成
- Continuous Delivery,Continuous Deployment 持续交付、持续部署
- DevOps ，开发运维一体化，提倡开发与运维活动紧密连接，共同协作，共同负责

有关CI、CD、DevOps的介绍可以参考以下链接和书籍
- https://www.ibm.com/cn-zh/topics/continuous-integration
- https://martinfowler.com/articles/continuousIntegration.html
- 《持续交付2.0》https://book.douban.com/subject/30419555/

[3]: <https://deepsource.io/blog/exponential-cost-of-fixing-bugs/> "缺陷成本"
